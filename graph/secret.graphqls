# 权限验证
# Auth check for user
directive @AuthCheck on MUTATION | QUERY | FIELD_DEFINITION

type SecretEnvWithHash {
  hash: String!
  secret: SecretEnv!
}

"""
加密环境变量
Encrypt environment variables
"""
type SecretEnv {
  envs: [LenValue!]!
  files: [LenValue!]!
}

""" 
加密值
Secret value
"""
type LenValue{
  key: String!
  len: Int!
}

"""
环境变量
Environments
"""
input Env {
  envs: [Kvalue!]!
  files: [Kvalue!]!
}

input Kvalue {
  key: String!
  value: String!
}


extend type Mutation {
  """
  上传智能合约 ABI
  Upload ink! contract
  """
  upload_secret(
    """
    secret
    """
    secret: Env!
  ): SecretEnvWithHash! @AuthCheck

  test(
    """
    hash
    """
    hash: String!
  ): Boolean!
}

extend type Query {
  """
  获取加密配置
  Get secret
  """
  secret(
    """
    hash
    """
    hash: String!
  ): SecretEnvWithHash!
}
